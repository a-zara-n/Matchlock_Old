<!DOCTYPE html>
<html>
  <head>
    <title>テスト</title>
    <style>
     input {
       display: block;
     }
     ul {
       list-style: none;
     }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.9/semantic.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.9/semantic.min.js"></script>
  </head>
  <body>
    <form id="chatbox" class="ui form">
      <div class="field">
        <textarea rows="20" cols="100"></textarea>
      </div>
    </form>
    <button id="intercept" class="ui primary button">intercept</button>
    <button id="forward"  class="ui button">forward </button>

    <script
      src="https://code.jquery.com/jquery-1.12.4.js"
      integrity="sha256-Qw82+bXyGq6MydymqBxNPYTaUXXq7c8v3CwiYwLLNXU="
      crossorigin="anonymous"></script>
    <script>
      $(function () {
        var socket = null;
        var msgBox = $("#chatbox textarea");
        var message = $("#message");
        $("#forward").click(function(){
          
          $.ajax({
                    url:'/api/is/forward',
                    type:'GET'
                })
                // Ajaxリクエストが成功した時発動
                .done( (data) => {

                })
                // Ajaxリクエストが失敗した時発動
                .fail( (data) => {

                })
                // Ajaxリクエストが成功・失敗どちらでも発動
                .always( (data) => {

                });        });
        $("#intercept").click(function(){
          if (!msgBox.val()) return false;
          if (!socket) {
            alert("エラー: WebSocket接続が行われていません。");
            return false;
          }
          socket.send(msgBox.val());
          msgBox.val("");
          return false;
        });
        if (!window["WebSocket"]) {
          alert("エラー: WebSocketに対応していないブラウザです。")
        } else {
          socket = new WebSocket("ws://{{.Host}}/connect");
          socket.onclose = function () {
            alert("接続が終了しました。");
          }
          socket.onmessage = function (e) {
            msgBox.val("");
            msgBox.val(e.data);
          }
        }
      })
    </script>
  </body>
</html>